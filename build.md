# 内网服务环境搭建

## 前言
- 如果你打算接手这个网站，请看下去，非常感谢！
- 下面是安装教程，可能有些繁琐，但是配置完成后，网站可自动化运营，无需再人工管理(只要电脑不出问题)
- 因为教室电脑系统可能相当老，或者是阉割的盗版系统，所以你可能会碰到各种问题，包括但不限于软件不兼容，缺少依赖库。。。
而且在学校你无法连接网络处理这些问题，如果实在不行请选择放弃，哎。。。
- 没有经验请不要随便重装教室电脑的系统，以免影响老师上课
- 隐瞒自己的身份，以免招来麻烦

## 解压网站数据
- 下载这个数据包，东西都在里面了
- 把数据包解压D盘(随便找个空间大的就好)
- 网站的文件在一个叫wordpress的文件夹里面(里面有许多xxx.php文件)
- 把这个文件夹剪切到D盘根目录
- 现在，网站根目录就是D:\wordpress
- 另外一个文件夹client里面是网站的自动运营脚本，找个文件夹你可以随便放，放wordpress下面也可以，方便找
- 依赖文件夹里面有说明，安装完可以删除

## 安装 Wampserver64
- 默认选English，后面可以改
- 安装路径不能带中文和空格
- 安装时问是否更换默认浏览器(IE)和文本编辑器(Notepad)，全部否，默认即可
- 打开时防火墙弹出安全警告，选择允许
- 桌面右下角找到软件图标(绿色的W)，右键，language，选择chinese
- 浏览器输入127.0.0.1即可访问站点

## 修改静态IP
- 桌面右下角，右键“网络”图标，打开“网络和Internet设置”
- 打开“网络和共享中心”，点击“连接”后面的网络名字，点“详细信息”
- 把IP地址，子网掩码，默认网关，DNS服务器抄下来
- 点“属性”，找到“Internet协议版本4(TCP/IPv4)"
- 填好相应的信息，确定
- 你的静态IP一般是192.168.1.X，X可以改，但可能导致冲突，所以默认就好
- 记住你的IP，其它班级的电脑需要输入这个才能访问这个网站

## 配置数据库
- 浏览器输入127.0.0.1/phpmyadmin
- 数据库默认用户名root，密码为空
- 点击“账户”选项，点击root用户后面的“修改权限”，然后点“修改密码”
- 记住密码，后面有用
- 新建数据库wordpress，并导入的wordpress.sql文件
- 点击wordpress，找到wp-option表，修改siteurl，和home字段，把后面的IP改成你的静态IP


## 配置虚拟主机
- 桌面右下角找到W图标，左键，选择“Apache”，然后选择“httpd-vhosts.conf"
- 删除里面的内容，把解压得到的httpd-vhosts.conf文件的内容复制进去，保存
- 同样，选择“PHP”，点击“PHP设置”，把，upload_max_filesize调大点(默认2MB)
- 找到W图标，左键，重启所有服务
- 打开浏览器，输入127.0.0.1或者你的静态IP，显示“数据库连接错误”

## 设置wordpress
- 修改D:\wordpress\wp-config.php文件，按提示填好数据库名和数据库密码，保存
- 网站配置完成


## 配置网站运营脚本
- 电脑安装Python3，一直Next，后面询问是否添加到PATH环境变量，打✔，Next
- 安装相应依赖库(我在里面放了安装说明)
- 脚本在client文件夹里面，放哪了你应该记得
- 右键“此电脑”或者“我的电脑”，点管理，点“计划任务程序”
- 点“创建任务”，名字喝描述随便写，“使用最高权限运行”也勾上
- 新建“触发器”，每天，然后设置时间
- “操作”为“启动程序”，程序选择client文件夹里面的update.py
- 服务器那边6:00,10:00,14:00,18:00,22:00一天更新五次
- 计划任务的触发器可以多设置几个，时间在上述时间后一点点即可，电脑没开机没有更新？
没关系，下一次任务执行时，会自动把没更新的补上
- 再新建一个任务，每天或者每周运行一次，时间随便，只要那时候电脑是开机的，程序为clean.pyw,这个是清理过期文章用的
- 程序都是在后台运行，什么也看不到，不会影响老师上课~请确保电脑开机

## 最后
- 为了防止同学误删，请右键网站文件夹和client文件夹，点“隐藏”，然后选“仅将更改应用于此文件夹”，确定
- 关机，然后按住DEL键(F8或者ESC键)开机，进入BIOS界面，找到自动开机选项，设置教室电脑早自习前开机，6:00之前


# 服务器端配置

- 服务器端包括爬虫程序和[外网](http://www.hnyz.fun)网站，运行环境为linux  
- 内网虽然停摆了，但是爬虫一直在正常工作，每天都有上传数据，外网目前访问量凄惨  
- 为了减少麻烦，服务器端我们继续维护，你只要建好内网即可，主要用户在学校内部(回家有网了谁还看我这外网，都打王者农药去了)
- 所以这里不写服务器端的说明(懒) 